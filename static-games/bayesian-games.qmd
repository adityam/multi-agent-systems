---
title: Bayesian Games

execute:
  echo: false
  freeze: true
  cache: true
---

So far, we have restricted attention to simultaneous move games where players have perfect knowledge of the utility functions of other players. This is not always true in practice. In this section, we will consider games where players have uncertainty about the utility functions of other players, and this uncertainty may be different for different players. Such games are called **games with incomplete information**. We will focus on the special case when players have a _subject_ probability distribution on the uncertainty. Such games are called **Bayesian Games**.

```{julia}
#| output: false
# Install packages

# using Pkg; Pkg.activate(".")
# for pkg in ["IJulia", "Revise", "Hyperscript"]
#    Pkg.add(pkg)
# end
# 
# Installing Jupyter Cache
# Pkg.add("Conda")
# using Conda
# Conda.add("jupyter-cache")

using Revise

include("../julia/typeset-games.jl")
```

## An illustrative example

To iilustrate such games, let's consider a variation of battle of sexes, where player 2 may either want to meet player 1 or may want to avoid it. For simplicity we assume that player 1 is the same as before. We will model it by saying that there are two **types** of player 2; the type of the player is determined by **events in nature**, and that each player has a probability distribution on the events in nature (for simplicity, we will assume that this probability distribution is common knowledge between the players, but it is possible to model Bayesian games where each player has a different subjective probability on the events in nature). 

More formally, we assume that there are two states in nature, modelled by 
$$
  Ω = \{ ω_1, ω_2 \}.
$$
In state $ω_1$, player 2 wants to meet player 1 while in state $ω_2$, player 2 wants to avoid player 1. Furthermore, there is a prior belief $p$ on $Ω$ which we will assume is given by
$$
  p(ω_1) = \tfrac 12
  \quad\text{and}\quad
  p(ω_2) = \tfrac 12.
$$

Each player has a type, which we will denote by $t_i$ for player $i$ (there is a slight notational conflict as we had sometimes used $t_i$ to denote alternative strategies for players). The set of types of player $i$ is denoted by $\ALPHABET T_i$. In the above example,
$$
  \ALPHABET T_1 = \{1\}
  \quad\text{and}\quad
  \ALPHABET T_2 = \{1, 2\}.
$$

The important aspect of modeling such games is the **information structure**, i.e., who knows what about the states of nature. The information structure is modelled by a **signal** $τ_i$ from the state of nature to player's type. For this example, we will assume that
$$
  τ_1(ω_1) = τ_1(ω_2) = 1
  \quad\text{and}\quad
  τ_2(ω_1) = 1, τ_2(ω_2) = 2.
$$
Thus, player 2 knows the state of nature (i.e., it knows whether it wants to meet with player 1 or not), while player 1 does not know the tate of nature (i.e., she doesn't know if player 2 wants to meet with her or not). 

Thus, effectively the type $t_i = τ_i(ω)$ of the player is a random variable and the information structure can be thought of as the collection of partition generated by the types of each player, i.e., $σ(t_1)$ and $α(t_2)$ (where $σ(⋅)$ means the sigma algebra generated by a random variable). Thus, for the above example, we can visualize the information structure as shown in @fig-info-structure

:::{#fig-info-structure layout-ncol=2}
![Player 1](figures/svg/info-structures1.svg){#fig-info-structure-a}

![Player 2](figures/svg/info-structures2.svg){#fig-info-structure-b}

Information structure of the modified battle of sexes game
:::

We will use a slightly different terminology and call the moves of the players as **actions** (and denote them by $a_i \in \ALPHABET A_i$. The **pure strategy** of a player is defined as a map from its type to its actions, i.e., 
$$
  s_i \colon \ALPHABET T_i \to \ALPHABET A_i.
$$
This means that in the above example player 2 of type 1 (the one who wants to meet with player 1) may choose actions differently from player 2 of type 2 (the one who wants to avoid player 1). 

Note that player 1 has two pure strategies:
$$
   1 \mapsto \mathsf{F},
   \quad \text{and} \quad
   1 \mapsto \mathsf{O}
$$
while player 2 has four pure strategies:
$$
  1 \mapsto \mathsf{F}, 2 \mapsto \mathsf{F},
  \quad
  1 \mapsto \mathsf{F}, 2 \mapsto \mathsf{O},
  \quad
  1 \mapsto \mathsf{O}, 2 \mapsto \mathsf{F},
  \quad
  1 \mapsto \mathsf{O}, 2 \mapsto \mathsf{O}.
$$
For simplicity of notation, we will simply denote them as follows:
$$
  \ALPHABET S_1 = \{ \mathsf{F}, \mathsf{O} \}
  \quad\text{and}\quad
  \ALPHABET S_2 = \{ \mathsf{FF}, \mathsf{FO}, \mathsf{OF}, \mathsf{OO} \}.
$$



As was the case in games with complete information, a **mixed strategy** $σ_i$ is a probability distribution over a set of pure strategies. 

There are two ways to model the utility function of the players. Utilities could be either modelled as a function of events in nature and strategy profile of players or as a function of type profile of players and strategy profile of players. For this example, we will take the former approach. Thus, 
$$
  u_i \colon Ω × \ALPHABET S \to \reals, \quad i \in \ALPHABET N.
$$

For two player finite games, a compact way to write the utility function is to draw the bimatrix representation for each $ω \in Ω$. For instance, in the above example, we may consider

```{julia}
#| layout-ncol: 2
#| label: fig-Bayesian-BoS
#| fig-cap: A modified battle of sexes game with incomplete information
#| fig-subcap: 
#|      - $ω_1$
#|      - $ω_2$

S = ["F", "O"]
SS = ["FF", "FO", "OF", "OO"]

game(S, S, [2 0; 0 1], [1 0; 0 2]) |> display
game(S, S, [2 0; 0 1], [0 2; 1 0]) |> display
```

Given a pure strategy profile $(s_1, s_2)$, the utility of player $i$ is
$$
  U_i(s_1, s_2) = \sum_{ω \in Ω} \sum_{t_1 \in \ALPHABET T_1} \sum_{t_2 \in \ALPHABET T_2}
  p(ω) u_i(ω, s_1( t_1(ω) ) s_2( t_2(ω) ) ).
$$
The payoff of a mixed strategy profile $(σ_1, σ_2)$ is defined as
$$
  U_i(σ_1, σ_2) = \sum_{s_1 \in \ALPHABET S_1} \sum_{s_2 \in \ALPHABET S_2} 
  σ_1(s_1) σ_2(s_2) U_i(s_1, s_2).
$$

The equilibrium of a Bayesian game is called **Bayesian equilibrium** (abbreviated as BNE). There are two equivalent methods to define and compute BNE of Bayesian game. We describe both of them below.

### Method 1: Ex-ante view {-}

According to the ex-ante view, we view the game before nature has played. A strategy profile $(s_1, s_2)$ is a (pure strategy) BNE if
$$
  U_i(s_i, s_{-i}) \ge U_i(s'_{i}, s_{-i}),
  \quad \forall i \in \ALPHABET N, s'_i \in \ALPHABET S_i.
$$
Note that the definition BNE is similar to that of NE; the difference is in how the utility function $U_i$ is defined. A mixed strategy BNE is defined in a similar manner.

Thus, if we compute the utility function $U_i(s_1, s_2)$ for all pure strategy profiles, we can easily find the BNE. For instance, for the above game, the utility function $U_i(s_1, s_2)$ can be computed as follows:
\begin{align*}
  U(\mathsf{F}, \mathsf{FF}) &= p(ω_1) u(ω_1, \mathsf{F}, \mathsf{F}) + p(ω_2) u(ω_2, \mathsf{F}, \mathsf{F})
  = \tfrac 12 (2,1) + \tfrac 12 (2,0) = (2, \tfrac 12) \\
  U(\mathsf{F}, \mathsf{FO}) &= p(ω_1) u(ω_1, \mathsf{F}, \mathsf{F}) + p(ω_2) u(ω_2, \mathsf{F}, \mathsf{O})
  = \tfrac 12 (2,1) + \tfrac 12 (0,2) = (1, \tfrac 32) \\
  \cdots &= \cdots
\end{align*}

We can write such an **normal-form reduction** of the game as a bimatrix game:

:::{#fig-BoS-normal}
```{julia}
game(S, SS, [2 1 1 1; 0 1//2 1//2 1], [1//2 2//3 0 1; 1//2 0 3//2 1])
```
Normal form reduction of the modified battle of sexes game
:::

We can then identify a BNE of the orginal game by identifying the NE of its normal-form rediction. Although this approach is simple, it is not very attractive because the normal-form reduction has large strategy spaces (exponential in the number of types) and we have already seen that it difficult to compute NE of games with large strategy spaces.

### Method 2: Interim view {-}

According to the interim view, we view the game after nature has played; so each player knows its type. We can consider each player of each time (i.e., each $(i,t_i)$ as a separete player. Thus, the game has $\prod_{i \in \ALPHABET N} |\ALPHABET T_i|$ players.

For a two player game, given an action $a_i$ of player~$i$ and a pure ss_{-i}$ of the player other than~$i$, the utility of player $i$ of type $t_i$ is given by
$$
  U_{i.t_i}(a_i, s_{-i})
  = \sum_{ω \in Ω} \sum_{t_{-i} \in \ALPHABET T_{-i}}
  p(ω | t_i) u_i(ω, a_i, s_{-i}(t_{-i}(ω))).
$$
Note that the payoff depends on the **belief** of player $i.t_i$ which is given by $p(ω | t_i)$. 

When player $-i$ is playing a mixed strategy $σ_{-i}$, then the expected utility is given by
$$
  U_{i.t_i}(a_i, σ_{-i})
  = \sum_{s_{-i} \in \ALPHABET S_{-i}} σ_{-i}(s_{-i}) U_{i.t_i}(a_i, s_{-i}).
$$

In this formulation, a strategy profile $σ^*$ is a **Bayesian Nash equilibrium** if for every player $i$ and every type $t_i \in \ALPHABET T_i$, we have
$$
  U_{i.t_i}( σ_i(t_i), σ_{-i}) \ge
  U_{i.t_i}( a_i,      σ_{-i}), \quad \forall a_i \in \ALPHABET A_i.
$$

A key result in Bayesian games is that the two definitions of BNE (one for the ex-ante view and the other for the interim view) are equivalent (provided the model is parscimonious, i.e., $p(ω) > 0$ for all $ω$). In particular, when players are playing BNE, no player has a profitable deviation _after_ knowing his type if and only if he has no profitable deviation _before_ knowing his type.

Combing back to our example, we can write the utility function of all the players as follows:

```{julia}
#| layout-ncol: 3
#| label: fig-Bayesian-BoS-interim
#| fig-cap: Interim-view of battle of sexes game
#| fig-subcap: 
#|      - Player 1.1 (row player)
#|      - Player 2.1 (col player)
#|      - Player 2.2 (col player)

game1(S, SS, [2 1 1 0; 0 1//2 1//2 1]) |> display
game1(S, S, [1 0; 0 2]) |> display
game1(S, S, [0 2; 1 0]) |> display
```

Note that player 2.1 does not care what player 2.2 does. But player 1.1's strategy depends on both player 2.1 and player 2.2, which indirectly couples the two players.

We now show how to find the BNE via the interim strategy.

First we check for all pure strategy BNE by trying to find a fixed point of BR maps.

- If P1.1 plays $\mathsf{F}$, BR of P2.1 is $\mathsf{F}$ and BR of P2.2 is $\mathsf{O}$.
- If P2 is playing $\mathsf{FO}$, BR of P1.1 is $\mathsf{F}$. Thus, $(\mathsf{F}, \mathsf{FO})$ is BNE.

<!-- -->

- If P1.1 plays $\mathsf{O}$, BR of P2.1 is $\mathsf{O}$ and BR of P2.2 is $\mathsf{F}$.
- If P2 is playing $\mathsf{FO}$, BR of P1.1 is $\mathsf{F}$. Thus, $(\mathsf{O}, \mathsf{OF})$ is **not** BNE.

Now we consider **mixed strategy** BNE. We have two possibilities:

**Case 1** P1 is playing a pure strategy. Then P2.1 and P2.2 will also play pure strategies because their BR are unique. We have already compute the NE in pure strategies.

**Case 2** P2 is playing a mixed strategy $σ_1 = (p, 1-p)$. Consider mixed strategies
$$
   σ_{2.1} = (q_1, 1-q_1) 
  \quad\text{and}\quad
   σ_{2.2} = (q_2, 1-q_2) 
$$
of player 2. Note that we have assumed that $p \in (0,1)$ but $q_1, q_2 \in [0, 1]$. 

- if $q_1 \in (0,1)$, then by the invariance principle, 
  $$
    U_{2.1}(σ_1, \mathsf{F}) = U_{2.1}(σ_1, \mathsf{O})
    \implies p = 2 (1-p) \implies p = \frac 23.
  $$
- if $q_2 \in (0,1)$, then by the invariance principle, 
  $$
    U_{2.2}(σ_1, \mathsf{F}) = U_{2.1}(σ_1, \mathsf{O})
    \implies (1-p) = 2p  \implies p = \frac 13.
  $$
 
But $p$ must take a single value so only one of them can be true. Thus, either

- $q_1 \in (0, 1)$ and $q_2 \in \{0, 1\}$, or
- $q_2 \in (0, 1)$ and $q_1 \in \{0, 1\}$. 

We consider both these cases separately. 

**Case 2.1** $p \in (0,1)$, $q_1 \in (0,1)$, and $q_2 \in \{0, 1\}$. 

As argued before, in this case $p = \tfrac 23$. We consider the two values of $q_2$ separately.

- $q_2 = 0$. In this case, the mixed strategy of P2 is
  $$
      σ_2 = (0, q_1, 0, 1-q_1).
  $$
  By the invariance principle, for P1 to play a mixed strategy, it must be that
  $$
    U_1(\mathsf{F}, σ_2) = U_1(\mathsf{O}, σ_2)
    \implies
    q_1 = \tfrac 12 q_1 + (1 - q_1)
    \implies 
    q_1 = \tfrac 23.
  $$
  [We also need to check that P2.2 is playing her BR]{.text-danger}, i.e.,
  $$
    U_{2.2}(σ_1, \mathsf{F}) \le U_{2.2}(σ_1, \mathsf{O})
    \iff
    \tfrac 13 \le \tfrac 43
  $$
  which is true. Hence, the following is a mixed strategy NE.
  $$
    \bbox[5pt,border: 1px solid]{
    σ_1 = (\tfrac 23, \tfrac 13),
    \quad
    σ_{2.1} = (\tfrac 23, \tfrac 13),
    \quad
    σ_{2.2} = (0, 1).
   }
  $$

- $q_2 = 1$. In this case, the mixed strategy of P2 is
  $$
      σ_2 = (q_1, 0, 1-q_1, 0).
  $$
  By the invariance principle, for P1 to play a mixed strategy, it must be that
  $$
    U_1(\mathsf{F}, σ_2) = U_1(\mathsf{O}, σ_2)
    \implies
    2 q_1 + (1 - q_1) = \tfrac 12 (1 -q_1)
    \implies 
    q_1 = -\tfrac 13.
  $$
  Thus, there is no feasible solution in this case.

**Case 2.2** $p \in (0,1)$, $q_2 \in (0,1)$, and $q_1 \in \{0, 1\}$. 

As argued before, in this case $p = \tfrac 13$. [Just to show the possibility, we solve this case differently from Case 2.1]{.text-primary}

Since we know the strategy of P1, we compute the BR of P2.1. We know that
$$
  U_{2.1}(σ_1, \mathsf{F}) = \tfrac 13  
  \quad\text{and}\quad
  U_{2.1}(σ_1, \mathsf{O}) = \tfrac 43  
$$
Since $U_{2.1}(σ_1, \mathsf{F}) < U_{2.1}(σ_1, \mathsf{O})$, player 2.1 plays $\mathsf{O}$. Thus, from the point of view of P1, P2 is playing the mixed strategy
$$
  σ_2 = (0, 0, q_2, 1-q_2).
$$
[Unlike Case 2.1, we don't need to consider the other possibility because we have established that P2.1 plays $\mathsf{O}$]{.text-muted}

By the invariance principle, for P1 to play a mixed strategy, it must be that
$$
  U_1(\mathsf{F}, σ_2) = U_1(\mathsf{O}, σ_2)
  \implies
  q_2 = \tfrac 12 q_2 + (1-q_2)
  \implies
  q_2 = \tfrac 23.
$$
Hence, the following is a mixed strategy NE.
  $$
    \bbox[5pt,border: 1px solid]{
    σ_1 = (\tfrac 13, \tfrac 23),
    \quad
    σ_{2.1} = (1, 0).
    \quad
    σ_{2.2} = (\tfrac 23, \tfrac 13),
   }
  $$

:::{#exm-verify}
Using the normal form reduction of @fig-BoS-normal, verify that the following are mixed strategy NE:

- $σ_1 = (\tfrac 23, \tfrac 13)$ and $σ_2 = (0, \tfrac 23, 0, \tfrac 13)$.
- $σ_1 = (\tfrac 13, \tfrac 23)$ and $σ_2 = (0, 0, \tfrac 23, \tfrac 13)$.
:::

## Some examples

We now present some examples to highlight salient features of Bayesian Nash equilibirum

:::{#exm-info-can-hurt}
#### More information can hurt

Consider the following Bayesian game
```{julia}
#| layout-ncol: 2
game(["T", "B"], ["L", "M", "R"], [1 1 1; 4 0 0], [2 0 3; 4 0 5], caption="\$ω_1\$") |> display
game(["T", "B"], ["L", "M", "R"], [1 1 1; 4 0 0], [2 3 0; 4 5 0], caption="\$ω_2\$") |> display
```

where 
$$
  p(ω_1) = p(ω_2) = \tfrac 12
$$

Consider two information structures shown in @fig-info-can-hurt-1 and  @fig-info-can-hurt-2

:::{#fig-info-can-hurt-1 layout-ncol=2}
![Player 1](figures/svg/info-structures1.svg){#fig-info-can-hurt-1-a}

![Player 2](figures/svg/info-structures1.svg){#fig-info-can-hurt-1-b}

First information structure for @exm-info-can-hurt
:::

:::{#fig-info-can-hurt-2 layout-ncol=2}
![Player 1](figures/svg/info-structures1.svg){#fig-info-can-hurt-2-a}

![Player 2](figures/svg/info-structures2.svg){#fig-info-can-hurt-2-b}

Second information structure for @exm-info-can-hurt
:::

Compute the BNE for both cases.

Note that in the first information structure no player has any information about the state of the nature, while in the second information structure, player 2 has full knowledge of the state of nature. The solution will demonstrate that for each information structure the game has a unique BNE under dominant strategies, but the payoff to both players in the second case are worse than in the first case. Thus more information can hurt! A celebrated example of this phenomenon is [:Braess's paradox](https://en.wikipedia.org/wiki/Braess's_paradox) 

:::

:::{.callout-note}
#### Solution
**Case 1.** In this case, no player has any information. The normal form reduction of the game is given as follows. 
```{julia}
game(["T", "B"], ["L", "M", "R"], [1 1 1; 4 0 0], [2 1.5 1.5; 4 2.5 2.5]) |> display
```

Note that for player 2, $\mathsf{L}$ dominates $\mathsf{M}$ and $\mathsf{R}$. Thus, the reduced game is

```{julia}
game(["T", "B"], ["L"], [1; 4], [2; 4]) |> display
```

In this reduced game, for player 1 $\mathsf{B}$ dominates $\mathsf{T}$. Thus, the unique BNE of the game is $(\mathsf{B}, \mathsf{L})$ which **gives a payoff of $(4, 4)$**. 

**Case 2.** In this case, player 2 knows the state of nature. For $ω_1$, action $\mathsf{R}$ is the dominant action, so all other actions can be eliminated. 
Similarly, for $ω_1$, action $\mathsf{M}$ is the dominant action, so all other actions can be eliminated. The reduced game is given by

```{julia}
#| layout-ncol: 2
game(["T", "B"], ["R"], [1; 0], [3; 5], caption="\$ω_1\$") |> display
game(["T", "B"], ["M"], [1; 0], [3; 5], caption="\$ω_2\$") |> display
```

In this reduced game, for player 1, action $\mathsf{T}$ dominates $\mathsf{B}$. Thus, the unique BNE is $(\mathsf{T}, \mathsf{RM})$ with a payoff of $(1, (3, 3))$. 

Thus both players are worse off with the additional information.
:::

In the examples considered so far, the information structure is trivial: each player either knows everything or knows nothing. We now consider an example where the information structure is non-trivial. [Computing the BNE using the interim approach in this general case requires computing posterior probabilities]{.text-danger}

:::{#exm-inflection}
#### Inflection
Consider the following Bayesian game
```{julia}
#| layout-ncol: 3
game(["T", "B"], ["L", "R"], [2 0; 3 1], [2 0; 0 1], caption="\$ω_1\$") |> display
game(["T", "B"], ["L", "R"], [2 0; 0 1], [2 0; 0 1], caption="\$ω_2\$") |> display
game(["T", "B"], ["L", "R"], [2 0; 0 1], [2 0; 0 1], caption="\$ω_3\$") |> display
```
where 
$$
  p(ω_1) = \frac{9}{13}, 
  \quad
  p(ω_2) = \frac{3}{13},
  \quad 
  p(ω_3) = \frac{1}{13}
$$
and the information structure is

:::{#fig-inflection layout-ncol=2}
![Player 1](figures/svg/info-structures4.svg){#fig-inflection-a}

![Player 2](figures/svg/info-structures3.svg){#fig-inflection-b}

Information structure for @exm-inflection
:::

The information structure implies that

- At $ω_1$: P1 knows the payoffs. P2 does not know. P1 knows that P2 does not know.
- At $ω_2$: P1 knows the payoffs. P2 does not know. P1 does know whether P2 knows.
- At $ω_3$: Both players know the payoffs. P2 knows that P1 knows. P1 does not know that P2 knows.

Find the Bayesian Nash equilibrium of this game.
:::

:::{.callout-note}
#### Solution

We will follow the interim approach. Observe that the posterior probabilities of $Ω$ for each player is given as follows:
\begin{align*}
  \PR_{1.1}(ω) &= (1, 0, 0), &
  \PR_{1.2}(ω) &= (0, \tfrac 34, \tfrac 14), \\
  \PR_{2.1}(ω) &= (\tfrac 34, \tfrac 14, 0), &
  \PR_{2.2}(ω) &= (0, 0, 1).
\end{align*}

where the notation $\PR_{i.j}$ means the posterior probability of "player $i$ of type $j$".
Based on these posterior probabilities, we can write the interim utility function for each player:

```{julia}
#| layout-ncol: 2
game1(["T", "B"], ["LL", "LR", "RL", "RR"], [2 2 2 0; 3 3 1 1], caption="Player 1.1 (row player)") |> display
game1(["T", "B"], ["LL", "LR", "RL", "RR"], [2 3//2 1//2 0; 0 1//4 3//4 1], caption="Player 1.2 (row player)") |> display

game1(["TT", "TB", "BT", "BB"], ["L", "R"], [2 0; 3//2 1//4; 1//2 3//4; 0 1], caption="Player 2.1 (col player)") |> display
game1(["TT", "TB", "BT", "BB"], ["L", "R"], [2 0; 0 1; 2 0; 0 1], caption="Player 2.2 (col player)") |> display
```

This game can be simplified using IEDS as follows.

**Step 1:** For P1.1, $\mathsf{B}$ dominates $\mathsf{T}$. Removing $\mathsf{T}$ for P1.1, also eliminates $\mathsf{TT}$ and $\mathsf{TB}$ for P2.1 and P2.2. The resulting simplified game is as follows:

```{julia}
#| layout-ncol: 2
game1(["B"], ["LL", "LR", "RL", "RR"], [3 3 1 1], caption="Player 1.1 (row player)") |> display
game1(["T", "B"], ["LL", "LR", "RL", "RR"], [2 3//2 1//2 0; 0 1//4 3//4 1], caption="Player 1.2 (row player)") |> display

game1(["BT", "BB"], ["L", "R"], [1//2 3//4; 0 1], caption="Player 2.1 (col player)") |> display
game1(["BT", "BB"], ["L", "R"], [2 0; 0 1], caption="Player 2.2 (col player)") |> display
```

**Step 2:** In this reduced game, for P2.1, $\mathsf{L}$ dominates $\mathsf{R}$. Removing $\mathsf{R}$ for P2.1 also eliminates $\mathsf{RL}$ and $\mathsf{RR}$ for P1.1 and P1.2. The resulting simplified game is as follows:

```{julia}
#| layout-ncol: 2
game1(["B"], ["RL", "RR"], [1 1], caption="P1.1") |> display
game1(["T", "B"], ["RL", "RR"], [1//2 0; 3//4 1], caption="P1.2") |> display

game1(["BT", "BB"], ["R"], [3//4; 1], caption="P2.1") |> display
game1(["BT", "BB"], ["L", "R"], [2 0; 0 1], caption="P2.2") |> display
```

**Step 3:** In this reduced game, for P1.2, $\mathsf{B}$ dominates $\mathsf{T}$. Removing $\mathsf{T}$ for P1.2, also eliminates $\mathsf{BT}$ for P2.1 and P2.2. The resulting simplified game is as follows:

```{julia}
#| layout-ncol: 2
game1(["B"], ["RL", "RR"], [1 1], caption="P1.1") |> display
game1(["B"], ["RL", "RR"], [3//4 1], caption="P1.2") |> display

game1(["BB"], ["R"], [1], caption="P2.1") |> display
game1(["BB"], ["L", "R"], [0 1], caption="P2.2") |> display
```

**Step 4:** In this reduced game, for P2.2, $\mathsf{R}$ dominates $\mathsf{L}$. Removing $\mathsf{R}$ for P2.2 also eliminates $\mathsf{RR}$ for P1.1 and P1.2. The resulting simplified game is:

```{julia}
#| layout-ncol: 2
game1(["B"], ["RL"], [1], caption="P1.1") |> display
game1(["B"], ["RL"], [3//4], caption="P1.2") |> display

game1(["BB"], ["R"], [1], caption="P2.1") |> display
game1(["BB"], ["R"], [1], caption="P2.2") |> display
```

Thus, the unique BNE is: P1.1 plays $\mathsf{B}$; P1.2 plays $\mathsf{B}$, P2.1 plays $\mathsf{R}$ and P2.2 plays $\mathsf{R}$. 

[Observe that for $ω = ω_3$, both plays know the game, but the good outcome $(\mathsf{T}, \mathsf{L})$, which is also the NE of the game corresponding to $ω_3$ has been ruled out!
:::

:::{#exm-Bayes-2025}
Consider the following Bayesian game
```{julia}
#| layout-ncol: 2
game(["T", "B"], ["L", "R"], [2 0; 0 1], [0 3; 4 0], caption="\$ω_1\$.") |> display
game(["T", "B"], ["L", "R"], [0 3; 2 0], [3 1; 0 1], caption="\$ω_2\$.") |> display
```
where
$$
  p(ω_1) = \tfrac 13
  \quad\text{and}\quad
  p(ω_2) = \tfrac 23
$$
and the information structure is 

:::{#fig-ex-4 layout-ncol=2}
![Player 1](figures/svg/info-structures2.svg){#fig-ex-4-a}

![Player 2](figures/svg/info-structures1.svg){#fig-ex-4-b}

Information structure for @exm-Bayes-2025
:::

a. Write the interim form of the game. 
b. Using the interim form, find all the _pure_ strategy BNE of the game.
b. Using the interim form, find all the _mixed_ strategy BNE of the game.
:::

:::{.callout-note}
#### Solution

The interim games from the point of player 1.1 and 1.2 are the same as the games corresponding to $ω_1$ and $ω_2$. So, we only need to compute the interim game corresponding to player 2.1. 

```{julia}
#| layout-ncol: 3
game1(["T", "B"], ["L", "R"], [2 0; 0 1], caption="P1.1") |> display
game1(["T", "B"], ["L", "R"], [0 3; 2 0], caption="P1.2") |> display
game1(["TT", "TB", "BT", "BB"], ["L", "R"], [2 5//3; 0 5//3; 10//3 2//3;4//3 2//3], caption="P2.1") |> display
```

**Pure strategy BNE** 

- IF P2 plays $\mathsf{L}$, BR of P1.1 is $\mathsf{T} and BR of P1.2 is $\mathsf{B}$.
- If P1 is playing $\mathsf{TB}$, then BR of P2.1 is $\mathsf{R}$. Thus, $(\mathsf{TB}, \mathsf{L})$ is **not** BNE.

<!-- -->

- IF P2 plays $\mathsf{R}$, BR of P1.1 is $\mathsf{B} and BR of P1.2 is $\mathsf{T}$.
- If P1 is playing $\mathsf{BT}$, then BR of P2.1 is $\mathsf{L}$. Thus, $(\mathsf{BT}, \mathsf{R})$ is **not** BNE.

Thus, there is no pure strategy BNE.

**Mixed strategy BNE**
Let $σ_{1.1} = (p_1, 1 - p_1)$, $σ_{1.2} = (p_2, 1 - p_2)$ and $σ_{2.1} = (q, 1-q)$ be a mixed strategy NE. 

- If $p_1 \in (0, 1)$, then by the indifference principle, we must have
$$
  U_{1.1}(\mathsf{T}, σ_2) = U_{1.1}(\mathsf{B}, σ_2) \implies
  2q = 1 - q \implies q = \frac 13.
$$

- If $p_2 \in (0, 1)$, then by the indifference principle, we must have
$$
  U_{1.2}(\mathsf{T}, σ_2) = U_{1.2}(\mathsf{B}, σ_2) \implies
  3(1 - q) = 2 q \implies q = \frac 35.
$$

But $q$ must take a single value so only one of them can be true. Thus, either

- $p_1 \in (0,1)$ and $p_2 \in \{0, 1\}$, or
- $p_2 \in (0,1)$ and $p_1 \in \{0, 1\}$. 

We consider both these cases separately.

**Case 1.** $p_1 \in (0, 1)$. In this case, we have already computed that $q = \frac 13$. Thus,
$$
  U_{1.2}(\mathsf{T}, σ_2) = 2,
  \quad
  U_{1.2}(\mathsf{B}, σ_2) = \frac {2}{3}.
$$
Thus, the BR of P1.2 is $\mathsf{T}$. Hence $p_2 = 1$. Consequently, the strategy of P1 as viewed by P2.1 is
$$
  σ_1 = (p_1, 0, 1-p_1, 0).
$$
Now, by the indifference principle, we must have
$$
  U_{2.1}(σ_1, \mathsf{L}) = U_{2.1}(σ_1, \mathsf{R})
  \implies
  2 p_1 + \frac{10}{3}(1-p_1) = \frac{5}{3}p_1 + \frac{2}{3}(1-p_1)
  \implies p_1 = \frac{8}{7}.
$$
Since $p_1 \not\in [0, 1]$, this is not a valid probability distribution and hence **not** a BNE.

**Case 2.** $p_2 \in (0,1)$. In this case, we have already computed that $q = \frac{3}{5}$. Thus,
$$
  U_{1.1}(\mathsf{T}, σ_2) = \frac{6}{5},
  \quad
  U_{1.1}(\mathsf{B}, σ_2) = \frac {2}{5}.
$$
Thus, the BR of P1.1 is $\mathsf{T}$. Hence $p_1 = 1$. Consequently, the strategy of P1 as viewed by P2.1 is
$$
  σ_1 = (p_2, 1-p_2, 0, 0).
$$
Now, by the indifference principle, we must have
$$
  U_{2.1}(σ_1, \mathsf{L}) = U_{2.1}(σ_1, \mathsf{R})
  \implies
  2 p_2 = \frac{5}{3}
  \implies p_2 = \frac{5}{6}.
$$
Since $p_2 \in [0, 1]$, this is a valid probability distribution. Hence, the mixed strategy BNE is
$$
\bbox[5pt,border: 1px solid]{
  σ_{1.1} = (1, 0), \quad
  σ_{1.2} = (\tfrac{5}{6}, \tfrac{1}{6}), \quad
  σ_2 = (\tfrac{3}{5}, \tfrac{2}{5}).
}
$$
:::

## Bayesian games with continuous actions

In this section, we provide some examples of Bayesian games with continuous actions. For such games it is difficult to specify the space of all pure strategies of a player. Therefore, we typically restrict attention to a **parameteric family** of strategies. In particular, we follow the interim approach and proceed as follows:

- Consider the game from from the point of view of player $i$ of type $t_i$.

- Assume that all players other than player $i$ are using a parameteric strategy and write the expression for the expected utility of player $i$ of type $t_i$ as a function of its action and other players' strategies. 

- By the BR of player $i$ of type $t_i$ (typically by differentiatting its expected utility w.r.t.\ its action and setting it to zero). 

- The hope is that this BR will belong to the same parametric class. If so, by repeating the argument for all players, we get a system of equations between the parameters of the strategies. Solving them gives a BNE strategy.

Note that there is no guarantee that we will be able to find a BNE within any parameteric class; and identifying the appropriate parameteric class is bit of an art. 

In the examples that we provide below, we will typically look at BNE within the class of linear or affine strategies. 


:::{#exm-Bayes-first-price}
#### First price sealed bid auctions

Consider a game where two players present a sealed bid for an object. Let $v_i$ denote the player $i$'s valuation of the object, **which is private information to the player**. 

We will model this as a Bayesian game with a probability space with $Ω = [0,1]^2$ and $\PR$ being uniform distribution on $Ω$. Let $ω = (v_1, v_2) \in Ω$ denote the state of the world. The signal received by player $i$ is $v_1$ and the signal received by player 2 is $v_2$. 

Upon seeing their signals, each player chooses a bid $b_i$. In **first price** autions, the person with the highest bid gets the object and pays the amount equal to his bid. Thus, the utility of the players is:
$$
  u_i(v_i, v_{-j}, b_{i}, b_{-i}) =
  \begin{cases}
    v_i - b_i, & \text{if } b_i > b_j \\
    \frac{1}{2}(v_i - b_i), & \text{if } b_i = b_j \\
    0, & \text{if } b_i < b_j.
  \end{cases}
$$

Find the BNE of the game within the class of linear strategies, i.e., strategies of the form
$$
  s_i(v_i) = α_i v_i.
$$
:::

:::{.callout-note}
#### Solution

We first compute the interim expected utility of player $i$ of type $v_i$. For that matter, observe that posterior belief of player $i$ about the type of player $j$ is given by:
$$
  f(v_j|v_i) = 1, \quad v_j \in [0, 1].
$$
Thus, the interim expected utility is given by 
\begin{align*}
  U_{i.v_i}(b_i, s_j) &=
  \int_{0}^{1} u_i(v_i, v_j, b_i, s_j(v_j) f(v_j|v_i) dv_j \\
  &= \int_{0}^{(b_i/α_j)^{-}} (v_i - b_i) d v_j 
   + \int_{(b_i/α_j)^{-}}^{(b_i/α_j)^{+}} \tfrac 12 (v_i - b_i) d v_j 
   + \int_{(b_i/α_j)^{+}}^1 0 dv_j 
   \\
  &= (v_i - b_i) \frac{b_i}{α_j}
\end{align*}
which is concave in $b_i$. Thus, the interim BR is given by
$$
  \frac{∂}{∂b_i} U_{i.v_i}(b_i, s_j) = 0 
  \implies 
  \bbox[5pt,border: 1px solid]{b_i = \frac{v_i}{2}.}
$$
:::

By a similar argument, we can show that in $n$-player first price auctions, the BNE is to bid
$$
  b_i = \left(1 - \frac{1}{n}\right) v_i.
$$
Thus, the players shade their bids below their valuation, to balance the profit when the win against the risk of not winning. THe more the players in the auction, thje less they can affort to shade their bid. 

Earlier we had consider second price auctions (@sec-2nd-price) but we assumed that the valuations of all players were common knowledge. Now we consider the case where the player only knows his own valuation. 

:::{#exm-Bayes-second-price}
#### Second price sealed bid auctions

Consider the setup of @exm-Bayes-first-price but with the valuation function
$$
  u_i(v_i, v_{-j}, b_{i}, b_{-i}) =
  \begin{cases}
    v_i - b_j, & \text{if } b_i > b_j \\
    \frac{1}{2}(v_i - b_j), & \text{if } b_i = b_j \\
    0, & \text{if } b_i < b_j.
  \end{cases}
$$
Find the BNE of the game within the class of linear strategies, i.e., strategies of the form
$$
  s_i(v_i) = α_i v_i.
$$
:::

:::{.callout-note}
#### Solution

As before, we note that posterior belief of player $i$ about the type of player $j$ is given by:
$$
  f(v_j|v_i) = 1, \quad v_j \in [0, 1].
$$
Thus, the interim expected utility of player $i$ of type $v_i$ is given by 
\begin{align*}
  U_{i.v_i}(b_i, s_j) &=
  \int_{0}^{1} u_i(v_i, v_j, b_i, s_j(v_j) f(v_j|v_i) dv_j \\
  &= \int_{0}^{(b_i/α_j)^{-}} (v_i - α_j v_j ) d v_j 
   + \int_{(b_i/α_j)^{-}}^{(b_i/α_j)^{+}} \tfrac 12 (v_i - α_j v_j ) d v_j 
   + \int_{(b_i/α_j)^{+}}^1 0 dv_j 
   \\
  &= v_i \frac{b_i}{α_j} - \frac {1}{2} α_j \frac{b_i^2}{α_j^2} \\
  &= \frac{v_i b_i}{α_j} - \frac{b_i^2}{2 α_j}
\end{align*}
which is concave in $b_i$. Thus, the interim BR is given by
$$
  \frac{∂}{∂b_i} U_{i.v_i}(b_i, s_j) = 0 
  \implies 
  \bbox[5pt,border: 1px solid]{b_i = v_i.}
$$
:::

The above method is analytic. If one has a good guess about the BNE, an alternative method is to argue, as we did earlier in the course, that truthful bidding is a weakly dominant strategy for each player. 

## Bayesian games with common information


## Exercises {-}

:::{#exr-Bayes-pure}
Consider the following Bayesian game

```{julia}
#| layout-ncol: 2
game(["T", "B"], ["L", "R"], [1 0; 0 1], [1 2; 2 1], caption="\$ω_1\$") |> display
game(["T", "B"], ["L", "R"], [2 0; 4 2], [2 1; 4 3], caption="\$ω_2\$") |> display
```

where 
$$
  p(ω_1) = p(ω_2) = \tfrac 12
$$
and the information structure is 

:::{#fig-ex-1 layout-ncol=2}
![Player 1](figures/svg/info-structures2.svg){#fig-ex-1-a}

![Player 2](figures/svg/info-structures1.svg){#fig-ex-1-b}

Information structure for @exr-Bayes-pure
:::

a. Write the normal form reduction of the game and use it to find all **pure strategy** BNE.

b. Write the interim form of the game and use it to find all **pure strategy** BNE.

:::

:::{#exr-Bayes-mixed}
Consider the following Bayesian game
```{julia}
#| layout-ncol: 2
game(["T", "B"], ["L", "R"], [2 0; 0 4], [4 0; 0 -10], caption="\$ω_1\$.") |> display
game(["T", "B"], ["L", "R"], [4 0; 0 4], [-10 0; 0 4], caption="\$ω_2\$.") |> display
```
where
$$
  p(ω_1) = \tfrac 35
  \quad\text{and}\quad
  p(ω_2) = \tfrac 25
$$
and the information structure is 

:::{#fig-ex-2 layout-ncol=2}
![Player 1](figures/svg/info-structures2.svg){#fig-ex-2-a}

![Player 2](figures/svg/info-structures1.svg){#fig-ex-2-b}

Information structure for @exr-Bayes-mixed
:::

a. Write the normal form reduction of the game and use it to find all **mixed strategy** BNE.

b. Write the interim form of the game and use it to find all **mixed strategy** BNE.
:::
