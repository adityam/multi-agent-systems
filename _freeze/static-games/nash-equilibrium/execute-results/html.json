{
  "hash": "ccf9fae2523c31f0030da953f82d260b",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Nash equilibrium\nformat:\n  html:\n    include-in-header: \n     - ../static/html/vue.html\n\nexecute:\n  echo: false\n  freeze: true\n  cache: true\n---\n\nSo far we have looked at two solution concepts:\n\n- Rationalizable strategies, which don't exist for all games\n\n- Optimal or minmax strategies for zero-sum games.\n\nIn this section, we look at the most popular solution concept known as **Nash equilibrium** (which we will abbreviate to NE).\n\n\n\n## What is Nash equilibrium\n\n:::{.callout-tip}\n#### Informal definition of Nash equilibrium\n\nA strategy profile is a NE if no player can improve its performance by unilateral deviations.\n:::\n\n\nThe above definition can be written formally as follows.\n\n:::{#def-Nash-equil}\nA **Nash equilibrium** in pure strategies for a strategic game $\\mathscr{G} = \\langle N, (\\ALPHABET S_i)_{i \\in N}, (u_i)_{i \\in N} \\rangle$ is a strategy profile $s^* = (s^*_1, \\dots, s^*_n) \\in \\ALPHABET S$ such that for each $i \\in N$ the following is satisfied:\n$$\n  u_i(s_i^*, s_{-i}^*) \\ge u_i(s_i, s_{-i}^*),\n  \\quad \\forall s_i \\in \\ALPHABET S_i.\n$$\nThe payoff vector $u(s^*)$ is called the **equilibrium payoff** corresponding to NE $s^*$.\n:::\n\nAnother way to define NE is use **Best response correspondece** $\\BR_i \\colon \\ALPHABET S_{-i} \\rightrightarrows A_i$ defined as follows\n$$\n  \\BR_i(s_{-i}) = \\bigl\\{ s_i \\in \\ALPHABET S_i : u_i(s_i, s_{-i}) \\ge u_i(τ_i, s_{-i}), \\forall τ_i \\in \\ALPHABET S_i \\bigr\\}.\n$$\n\n:::{#def-Nash-equil-alt}\nA strategy profile $s^* \\in \\ALPHABET S$ is a **Nash equilibrium** if each player is playing a best response to the strategy profile of other players, i.e., \n$$\n  s_i^* \\in \\BR_i(s^*_{-i}), \\quad \\forall i \\in N.\n$$\n:::\n\n## Relationship with previous solution concepts\n\n### Relationship between NE and dominant strategy equilibrium\n\nConsider prisoner's dilemma game.\n\n::: {#a8503c04 .cell execution_count=2}\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><caption>Prisoner&#39;s Dilemma</caption><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;A&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;R&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;A&#125;&#36;</td><td>&#36;-2&#36;</td><td>&#36;-2&#36;</td><td>&#36;0&#36;</td><td>&#36;-3&#36;</td></tr><tr><td>&#36;\\mathsf&#123;R&#125;&#36;</td><td>&#36;-3&#36;</td><td>&#36;0&#36;</td><td>&#36;-1&#36;</td><td>&#36;-1&#36;</td></tr></table>\n```\n:::\n:::\n\n\nRecall that $(\\mathsf{A}, \\mathsf{A})$ was the equilibrium in strongly dominant strategies. It can be easily verified that is also a Nash equillbrium. In fact, we have the following general result:\n\n:::{#prp-NE-vs-dominant}\n  Any equilibrium in strongly or weakly dominant strategy is also a Nash equilibrium.\n:::\n\n:::{.callout-note}\n#### Proof\n\nSuppose $s^* \\in \\ALPHABET S$ is an equilibrium in strongly or weakly dominant strategies. Then, by definition, for all players $i \\in N$, we have\n$$\nu_i(s_i^*, s_{-i}) \\ge u_i(s_i, s_{-i}), \n  \\quad \\forall s_i \\in \\ALPHABET S_i, s_{-i} \\in \\ALPHABET S_{-i}.\n$$\nIn particular, setting $s_{-i} = s_{-i}^*$ gives\n$$\nu_i(s_i^*, s_{-i}^*) \\ge u_i(s_i, s_{-i}^*), \n  \\quad \\forall s_i \\in \\ALPHABET S_i.\n$$\nThus, $s^*$ is a Nash equilibrium.\n:::\n\n### Relationship between NE and rationalizable strategies\n\nRecall the following example discussed earlier:\n\n::: {#05893b4c .cell execution_count=3}\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;L&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;C&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;R&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;T&#125;&#36;</td><td>&#36;1&#36;</td><td>&#36;0&#36;</td><td>&#36;1&#36;</td><td>&#36;2&#36;</td><td>&#36;0&#36;</td><td>&#36;1&#36;</td></tr><tr><td>&#36;\\mathsf&#123;B&#125;&#36;</td><td>&#36;0&#36;</td><td>&#36;3&#36;</td><td>&#36;0&#36;</td><td>&#36;1&#36;</td><td>&#36;2&#36;</td><td>&#36;0&#36;</td></tr></table>\n```\n:::\n:::\n\n\nWe had shown earlier that $(\\mathsf{T}, \\mathsf{C})$ is a rationalizble strategy obtained by IEDS. It can be easily verified that it is also a Nash equilibrium. In fact, we have the following general result.\n\n:::{#prp-NE-vs-rationalizable}\n  Any rationalizable output come IEDS or IEWDS is a Nash equilibrium.\n:::\n\n:::{.callout-note}\n#### Proof Sketch\n\nFor IEDS, the proof hinges on the fact that at each step of IEDS, we remove strategies that are dominated and therefore cannot be part of the best response. \n\nFor IEWDS, we may remove some best response strategies, but anything that survives has to be a best response pair.\n:::\n\n### Relationship between NE and optimal strategies in zero sum games\n\nRecall the following example discussed earlier in @exm-value-zsg\n\n::: {#d04d4b49 .cell execution_count=4}\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<table class=\"game1\" data-quarto-disable-processing=\"true\" align=\"center\"><tr><td></td><td>&#36;\\mathsf&#123;L&#125;&#36;</td><td>&#36;\\mathsf&#123;C&#125;&#36;</td><td>&#36;\\mathsf&#123;R&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;T&#125;&#36;</td><td>&#36;2&#36;</td><td>&#36;-1&#36;</td><td>&#36;-2&#36;</td></tr><tr><td>&#36;\\mathsf&#123;M&#125;&#36;</td><td>&#36;1&#36;</td><td>&#36;0&#36;</td><td>&#36;1&#36;</td></tr><tr><td>&#36;\\mathsf&#123;B&#125;&#36;</td><td>&#36;-2&#36;</td><td>&#36;-1&#36;</td><td>&#36;2&#36;</td></tr></table>\n```\n:::\n:::\n\n\nWe had shown that $(\\mathsf{M}, \\mathsf{C})$ is an optimal strategy of this game. It can be easily verified that it is also a Nash equilibrium. In fact, we have the following general result:\n\n:::{#prp-NE-vs-optimal}\n  Any optimal strategy of a ZSG is a NE and vice versa.\n:::\n\n:::{.callout-note}\n#### Proof\n\nThis follows immediately from the saddle point property of optimal strategies.\n:::\n\n\nThe above discussion shows that the concept of Nash equilibrium generalizes all the solution concepts that we have discussed so far. The main advantage of Nash equilibrium is that it exists even when the previously discussed solution concepts do not. For instance, consider the following games.\n\n:::{#exm-battle-of-sexes}\n\nFind all NE (in pure strategies) for Battle of Sexes game.\n\n::: {#73d72bda .cell execution_count=5}\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><caption>Battle of Sexes game</caption><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;F&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;O&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;F&#125;&#36;</td><td>&#36;2&#36;</td><td>&#36;1&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td></tr><tr><td>&#36;\\mathsf&#123;O&#125;&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td><td>&#36;1&#36;</td><td>&#36;2&#36;</td></tr></table>\n```\n:::\n:::\n\n\n:::\n\n:::{#exm-chicken}\n\nFind all NE (in pure strategies) for the game of chicken\n\n::: {#c0f07d1d .cell execution_count=6}\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><caption>The game of chicken</caption><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;C&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;H&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;C&#125;&#36;</td><td>&#36;3&#36;</td><td>&#36;3&#36;</td><td>&#36;1&#36;</td><td>&#36;10&#36;</td></tr><tr><td>&#36;\\mathsf&#123;H&#125;&#36;</td><td>&#36;10&#36;</td><td>&#36;1&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td></tr></table>\n```\n:::\n:::\n\n\n:::\n\nNote that a game may not have an equilibrium in pure strategyes. For example, the game of matching pennies has no equilibrium in pure strategies. \n\n::: {#5aaa98bb .cell execution_count=7}\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><caption>Matching pennies game</caption><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;H&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;T&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;H&#125;&#36;</td><td>&#36;1&#36;</td><td>&#36;-1&#36;</td><td>&#36;-1&#36;</td><td>&#36;1&#36;</td></tr><tr><td>&#36;\\mathsf&#123;T&#125;&#36;</td><td>&#36;-1&#36;</td><td>&#36;1&#36;</td><td>&#36;1&#36;</td><td>&#36;-1&#36;</td></tr></table>\n```\n:::\n:::\n\n\nIt is natural to ask if we can seek a NE in mixed strategies in such instances. And, in general, **when does a game have a NE?**\n\nThis question was answered by [@Nash1950; @Nash1951] who showed that any finte game has a NE in mixed strategy. We will come to that proof later. \n\n## Computing NE in $2 × 2$ games\n\nWe start by a brute-force method to compute NE in $2 × 2$ games. This method is just for illustration. Based on the intuition from this method, we will later present an efficient method to compute NE. \n\nConsider the game shown below. We can check that the game has no NE in pure strategies.\n\n::: {#65e55669 .cell execution_count=8}\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><caption>Game with no NE in pure strategies</caption><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;L&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;R&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;T&#125;&#36;</td><td>&#36;1&#36;</td><td>&#36;-1&#36;</td><td>&#36;0&#36;</td><td>&#36;2&#36;</td></tr><tr><td>&#36;\\mathsf&#123;B&#125;&#36;</td><td>&#36;0&#36;</td><td>&#36;1&#36;</td><td>&#36;2&#36;</td><td>&#36;0&#36;</td></tr></table>\n```\n:::\n:::\n\n\nLet $σ_1 = (p, 1-p)$ and $σ_2 = (q, 1-q)$ be a NE in mixed strategies. Then, the probability distribution of the different actions is shown below:\n\n::: {#9822dfa7 .cell execution_count=9}\n\n::: {.cell-output .cell-output-display execution_count=25}\n```{=html}\n<table class=\"game1\" data-quarto-disable-processing=\"true\" align=\"center\"><caption>Probability of choosing different actions</caption><tr><td></td><td>&#36;\\mathsf&#123;L&#125;&#36;</td><td>&#36;\\mathsf&#123;R&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;T&#125;&#36;</td><td>&#36;pq&#36;</td><td>&#36;p&#40;1-q&#41;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;B&#125;&#36;</td><td>&#36;&#40;1-p&#41;q&#36;</td><td>&#36;&#40;1-p&#41;&#40;1-q&#41;&#36;</td></tr></table>\n```\n:::\n:::\n\n\nThus, we have\n\\begin{align*}\n  U_1(p, q) \\coloneqq U_1(σ_1, σ_2) &= 1 ⋅ pq + 0 ⋅ p (1-q) + 0 ⋅ (1-p) q + 2 ⋅ (1-p)(1-q) \\\\\n  &= 3pq - 2p -2q + 2,\n\\end{align*}\nand\n\\begin{align*}\n  U_2(p, q) \\coloneqq U_2(σ_1, σ_2) &= -1 ⋅ pq + 2 ⋅ p (1-q) + 1 ⋅ (1-p) q + 0 ⋅ (1-p)(1-q) \\\\\n  &= -4pq + 2p + q .\n\\end{align*}\n\nThus, we can think of this as a two player game on the unit square where $P_1$ chooses $p \\in [0,1]$ and $P_2$ chooses $q \\in [0,1]$ and the pageoff functions are $U_1(p, q)$ and $U_2(p,q)$, respectively. \n\nIn this notation, NE is a point $(p,q)$ such that\n$$\n  p \\in \\BR_1(q)\n  \\quad\\text{and}\\quad\n  q \\in \\BR_2(p).\n$$\n\nWe will now identify the best response maps $\\BR_1$ and $\\BR_2$ and then compute the NE. \n\n### Best response map of player 1\n\nRecall that\n$$\n  U_1(p,q) = 3 pq - 2p - 2q + 2 = (3q - 2) p - 2q + 2\n$$\nwhich is linear in $p$ (for a fixed $q$). Thus,\n$$\n  \\max_{p \\in [0,1]} U_1(p,q)\n  = \\begin{cases}\n    U_1(1, q) = q, & \\hbox{if } 3q - 2 \\ge 0 \\\\\n    U_1(0, q) = -2q + 2, & \\hbox{if } 3q - 2 < 0 \n  \\end{cases}\n$$\nand\n$$\n  \\arg\\max_{p \\in [0,1]} U_1(p,q)\n  = \\begin{cases}\n    1, & \\hbox{if } 3q - 2 > 0 \\\\\n    [0,1], & \\hbox{ if } 3q - 2 = 0 \\\\\n    0, & \\hbox{if } 3q - 2 < 0 \n  \\end{cases}\n$$\n\nWe can visual these results graphically, as shown in @fig-BR-1.\n    \n::: {#fig-BR-1 layout-ncol=2}\n\n![$\\max_{p \\in [0,1]} U_1(p,q)$ as a function of $q$](figures/svg/nash-equilibrium1.svg){#fig-BR-1-a}\n\n![$\\arg\\max_{p \\in [0,1]} U_1(p,q)$ as a function of $q$](figures/svg/nash-equilibrium2.svg){#fig-BR-1-b}\n\nBest response map for player 1\n:::\n\n### Best response map of player 2\n\nWe repeat the above process for player 2. \nRecall that\n$$\n  U_2(p,q) = -4 pq + 2p + q = (1 - 4p)q + 2p\n$$\nwhich is linear in $q$ (for a fixed $p$). Thus,\n$$\n  \\max_{q \\in [0,1]} U_2(p,q)\n  = \\begin{cases}\n    U_2(p, 0) =  2p, & \\hbox{if } 1 - 4p \\le 0 \\\\\n    U_2(p, 1) = -2p + 1, & \\hbox{if } 1 - 4p > 0 \n  \\end{cases}\n$$\nand\n$$\n  \\arg\\max_{q \\in [0,1]} U_2(p,q)\n  = \\begin{cases}\n    0, & \\hbox{if } 1 - 4p < \\\\\n    [0,1], & \\hbox{ if } 1 - 4p = 0 \\\\\n    1, & \\hbox{if } 1 - 4p > 0 \n  \\end{cases}\n$$\n\nWe can visual these results graphically, as shown in @fig-BR-2.\n    \n::: {#fig-BR-2 layout-ncol=2}\n\n![$\\max_{q \\in [0,1]} U_2(p,q)$ as a function of $p$](figures/svg/nash-equilibrium3.svg){#fig-BR-2-a}\n\n![$\\arg\\max_{q \\in [0,1]} U_2(p,q)$ as a function of $p$](figures/svg/nash-equilibrium4.svg){#fig-BR-2-b}\n\nBest response map for player 2\n:::\n\n### Identifying the NE\n\nTo compute the NE, we look at the two BR curves and find their point of intersection, as shown in @fig-BR-cap. \n\n![Intersection of the best response curves of the two players. Note that the axes of the best response curve of player 2 has been flipped](figures/svg/nash-equilibrium5.svg){#fig-BR-cap}\n\nThus, the NE is $σ_1 = (\\tfrac 14, \\tfrac 34)$ and $σ_2 = (\\tfrac 23, \\tfrac 13)$. \n\nNotice that each BR curve have a \"staircase\" appearance. If we are looking for an equilibrium in _strictly mixed strategies_ (i.e., $p \\in (0,1)$ and $q \\in (0,1)$), then the intersection point of the two BR curves will be the vertically straight line part of the BR curves. \n\nRecall that we have argued that\n$$\n  \\max_{p \\in [0,1]} U_1(p,q) = \n  \\begin{cases}\n    U_1(\\mathsf{T}, q), & q \\ge q^* \\\\\n    U_1(\\mathsf{B}, q), & q \\le q^* \n  \\end{cases}\n$$\nwhere $q^*$ is the point where $U_1(\\mathsf{T}, q) = U_1(\\mathsf{B}, q)$. \n\nBy a symmetric argument, we have that $p^*$ point in the BR curve for player 2 is the point where $U_2(p, \\mathsf{L}) = U_2(p, \\mathsf{R})$. \n\nThus, instead of drawing the BR curves, we could have directly found the mixed strategy NE $(p^*, q^*)$ as\n$$\n  \\bbox[5pt,border: 1px solid]{\n    \\begin{aligned}\n      q^* &: q \\hbox{ such that } U_1(\\mathsf{T}, q) = U_1(\\mathsf{B}, q) \\\\\n      p^* &: p \\hbox{ such that } U_2(p, \\mathsf{R}) = U_2(p, \\mathsf{B})\n    \\end{aligned}\n  }\n$$\nThis provides a general method of finding the NE for $2 × 2$ games, which we use in general.\n\n:::{#exm-battle-of-sexes-all}\nFind all the NE of battle of sexes game.\n\n::: {#9cb11190 .cell execution_count=10}\n\n::: {.cell-output .cell-output-display execution_count=26}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><caption>Battle of Sexes game</caption><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;F&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;O&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;F&#125;&#36;</td><td>&#36;2&#36;</td><td>&#36;1&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td></tr><tr><td>&#36;\\mathsf&#123;O&#125;&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td><td>&#36;1&#36;</td><td>&#36;2&#36;</td></tr></table>\n```\n:::\n:::\n\n\n:::\n\n:::{.callout-note}\n#### Solution\n\nWe have already identified the pure strategy NE in @exr-battle-of-sexes. We now consider NE in strictly mixed strategies. \n\nLet $σ_1 = (p, 1-p)$ and $σ_2 = (q, 1-q)$ be a NE in mixed strategies. Then, the equilibrium value of $p$ is such that\n$$\nU_2(p, \\mathsf{F}) = U_2(p, \\mathsf{O}) \n$$\nHence,\n$$\n  p = 2 (1 - p) \\implies p = \\tfrac 23.\n$$\n\nSimilarly, the equilibrium value of $q$ is such that\n$$\n  U_1(\\mathsf{F}, q) = U_1(\\mathsf{O}, q)\n$$\nHence,\n$$ 2 q = 1 - q \\implies q = \\tfrac 13.$$\nThus, in addition to the two pure strategy NE, we have $σ_1 = (\\tfrac 23, \\tfrac 13)$ and $σ_2 = (\\tfrac 13, \\tfrac 23)$ is a mixed strategy NE.\n:::\n\n## The indifference principle\n\nWe now present a general method to compute NE for finite games. The method relies on the following characterization of NE.\n\n:::{#thm-NE-property}\nLet $\\mathscr{G} = \\langle N, (\\ALPHABET S_i)_{i \\in N}, (u_i)_{i \\in N} \\rangle$ be a finite strategic game. Then $σ^* = (σ^*_1, \\dots, σ^*_n)$, where $σ^*_i \\in Δ(\\ALPHABET S_i)$, $i \\in N$< is a mixed strategy NE of $\\mathscr{G}$ [if and only if]{.text-danger} for every player $i \\in N$ and every pure strategy $s_i$ in the support of $σ^*_i$ (i.e., every $s_i$ such that $σ^*_i(s_i) > 0$), we have\n$$\n    s_i \\in \\BR_i(σ^*_{-i}).\n$$\n:::\n\n:::{.callout-note}\n#### Proof\n\n- $(\\implies)$ Suppose there is a $s_i$ in the support of $σ^*_i$ (i.e., $σ^*_i(s_i) > 0$) but $s_i \\not\\in \\BR_{i}(σ^*_{-i})$. Then, by linearity of $U_i(σ_i, σ^*_{-i})$ in $σ_i$, player $i$ can increase its payoff by transferring the probability mass on $s_i$ to an action that is a BR. This will imply that $σ^*_i$ is not a Br, which is a contradiction. Thus, our initial supposition must be incorrect and $s_i \\in \\BR_i(σ^*_{-i})$.\n\n- $(\\impliedby)$ Suppose for every player $i \\in N$ and every action $s_i$ in the support of $σ^*_i$ is a BR of $σ^*_{-i}$ but $σ^*$ is not a NE. Then, there must be a player $i$ such that $σ^*_i$ is not a BR to $σ^*_{-i}$. \n\n  Since $σ^*_i$ is not a BR, there must be a mixed strategy $τ_i$ such that \n  \\begin{equation}\\label{eq:ineq}\n      U_i(σ^*_i, σ^*_{-i}) < U_i(τ_i, σ^*_{-i}).\n  \\end{equation}\n  Now consider a $t_i$ in the support of $τ_i$ and $s_i$ in the support of $σ^*_i$. By linearity of $U_i$, we have\n  $$\n    U_i(t_i, σ^*_{-i}) = U_i(τ_i, σ^*_{-i})\n  $$\n  and\n  $$\n    U_i(s_i, σ^*_{-i}) = U_i(σ^*_i, σ^*_{-i}).\n  $$\n  Eq. \\eqref{eq:ineq} implies that $U_i(t_i, σ^*_{-i}) > U_i(s_i, σ^*_{-i})$. This means that $s_i$ is not a BR of $σ^*_{-i}$, which is a contraction. Hence, our supposition that $σ^*_i$ is not a NE must be incorrect.\n:::\n\nAn immediate consequence of the previous result is the following.\n\n:::{#thm-indifference-principle}\n#### The indifference principle\n  Let $σ^* = (σ^*_1, \\dots, σ^*_n)$ be a NE in mixed strategy. Then, we have the following:\n\n  - For any $s_i$ such that $σ^*_i(s_i) > 0$, we have\n    $$\n        U_i(s_i, σ^*_{-i}) = U_i(σ^*_i, σ^*_{-i}).\n    $$\n\n  - For any $s_i$ such that $σ^*_i(s_i) = 0$, we have\n    $$\n        U_i(s_i, σ^*_{-i}) \\le U_i(σ^*_i, σ^*_{-i}).\n    $$\n:::\n\n:::{.callout-note}\n#### Proof\n\nFrom @thm-NE-property, we know that every pure strategy in the support of $σ^*_i$ must be a BR to $σ^*_{-i}$ and hence all such strategies must have the same payoff. Moreover, if all the pure strategies in the support of $σ^*_i$ have the same payoff, their payoff must be the same as the payoff of $σ^*_i$. This establishes the first property.\n\nThe second property follows from the definition of NE.\n:::\n\n@thm-indifference-principle can be used to compute the NE of general two-player finite game. Let $(σ^*_1, σ^*_2)$ be a mixed strategy NE. Let\n$$\n  \\text{supp}(σ^*_i) = \\{ s_i \\in \\ALPHABET S_i : σ^*_i(s_i) > 0 \\}\n$$\ndenote the support of $σ^*_i$. From @thm-indifference-principle, we have that for any $s^∘_i \\in \\text{supp}(σ^*_i)$, $i \\in \\{1, 2\\}$, we must have\n\\begin{align*}\n  U_1(s^∘_1, σ^*_2) &= U_1(s_1, σ^*_2), & s_1 &\\in \\text{supp}(σ^*_1) \\\\ \n  U_1(s^∘_1, σ^*_2) &\\ge U_1(t_1, σ^*_2), & t_1 &\\not\\in \\text{supp}(σ^*_1) \n\\end{align*}\nand\n\\begin{align*}\n  U_2(σ^*_1, s^∘_2) &= U_2(σ^*_1, s_2), & s_2 &\\in \\text{supp}(σ^*_2) \\\\ \n  U_2(σ^*_1, s^∘_2) &\\ge U_2(σ^*_1, t_2), & t_2 &\\not\\in \\text{supp}(σ^*_2) \n\\end{align*}\n\nNote that for any given choice of $\\text{supp}(σ^*_1)$ and $\\text{supp}(σ^*_2)$, we can check if the above equations have a consistent solution. If they do, that solutin is a NE. \n\nThe difficulty is that we do not know the support of $σ^*_1$ and $σ^*_2$. So, we need to repeat the above process for each choice of supports. Computing NE by such a brute-force search has an exponential complexity in $\\ABS{\\ALPHABET S_1}$ and $\\ABS{\\ALPHABET S_2}$. \n\n:::{#exm-NE-2x3}\nCompute all NE of the following game.\n\n::: {#e13db026 .cell execution_count=11}\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;L&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;C&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;R&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;T&#125;&#36;</td><td>&#36;7&#36;</td><td>&#36;2&#36;</td><td>&#36;2&#36;</td><td>&#36;7&#36;</td><td>&#36;3&#36;</td><td>&#36;6&#36;</td></tr><tr><td>&#36;\\mathsf&#123;B&#125;&#36;</td><td>&#36;2&#36;</td><td>&#36;7&#36;</td><td>&#36;7&#36;</td><td>&#36;2&#36;</td><td>&#36;4&#36;</td><td>&#36;5&#36;</td></tr></table>\n```\n:::\n:::\n\n\n:::\n\n:::{.callout-note}\n#### Solution\n\nWe first check for pure strategy NE by inspection and see that the game has no pure strategy NE. \n\nTo search for mixed strategy NE, we will consider all possible choices for the support for mixed strategyes for both players. Player 1 has two pure strategies and any mixed strategy must randomize between them. For player 2, there are three pure strategies, so there are $\\binom{3}{2} + \\binom{3}{3} = 4$ possible choices for the support of mixed strategies. We must search for NE in each of these cases.\n\nFor all possibilities, we will assume that \n$$\n  σ^*_1 = (p[\\mathsf{T}], 1-p[\\mathsf{B}])\n  \\quad\\text{and}\\quad\n  σ^*_2 = (q_1[\\mathsf{L}], q_2[\\mathsf{C}], q_3[\\mathsf{R}])\n$$\nwhere $q_1, q_2, q_3 \\ge 0$ and $q_1 + q_2 + q_3 = 1$. Thus,\n\\begin{align*}\n  U_1(\\mathsf{T}, σ^*_2) &= 7q_1  + 2 q_2 + 3 q_3 \\\\\n  U_1(\\mathsf{B}, σ^*_2) &= 2q_1  + 7 q_2 + 4 q_3\n\\end{align*}\nand\n\\begin{align*}\n  U_2(σ^*_1, \\mathsf{L}) &= 2 p + 7(1-p) = -5p + 7 \\\\\n  U_2(σ^*_1, \\mathsf{C}) &= 7p + 2(1-p) = 5p + 2 \\\\\n  U_2(σ^*_1, \\mathsf{R}) &= 6p + 5(1-p) = p + 5\n\\end{align*}\n\n- **Case 1:** Assume that $\\text{supp}(σ^*_2) = \\{\\mathsf{L}, \\mathsf{C}, \\mathsf{R}\\}$ so $q_1, q_2, q_3 > 0$. By the irrelevance principle, we must have\n   $$\n      U_1(\\mathsf{T}, σ^*_2) = U_1(\\mathsf{B}, σ^*_2) \n   $$\n   and\n   $$\n    U_2(σ^*_1, \\mathsf{L}) = U_2(σ^*_1, \\mathsf{C}) = U_2(σ^*_1, \\mathsf{R}).\n   $$\n   The second set of equations has no consistent solution for $p$. Thus, there is no NE in this case.\n\n\n- **Case 2:** Assume that $\\text{supp}(σ^*_2) = \\{\\mathsf{L}, \\mathsf{C}\\}$, i.e., $q_1, q_2 > 0$ and $q_3 = 0$. By the irrelevance principle, we must have\n   $$\n      U_1(\\mathsf{T}, σ^*_2) = U_1(\\mathsf{B}, σ^*_2) \n   $$\n   and\n   $$\n    U_2(σ^*_1, \\mathsf{L}) = U_2(σ^*_1, \\mathsf{C}) \\ge U_2(σ^*_1, \\mathsf{R}).\n   $$\n   Solving $U_2(σ^*_1, \\mathsf{L}) = U_2(σ^*_1, \\mathsf{C})$, we get $p = \\tfrac 12$ and $U_2(σ^*_1, \\mathsf{L}) = U_2(σ^*_1, \\mathsf{C}) = 4.5$. \n\n   We now check $U_2(σ^*_1, \\mathsf{R}) = p + 5 = 5.5 > 4.5$. Thus, the second system of equations has no consistent solution for $p$. Thus, there is no NE in this case.\n\n- **Case 3:** Assume that $\\text{supp}(σ^*_2) = \\{\\mathsf{L}, \\mathsf{R}\\}$, i.e., $q_1, q_3 > 0$ and $q_2 = 0$. By the irrelevance principle, we must have\n   $$\n      U_1(\\mathsf{T}, σ^*_2) = U_1(\\mathsf{B}, σ^*_2) \n   $$\n   and\n   $$\n    U_2(σ^*_1, \\mathsf{L}) = U_2(σ^*_1, \\mathsf{R}) \\ge U_2(σ^*_1, \\mathsf{C}).\n   $$\n   Solving $U_2(σ^*_1, \\mathsf{L}) = U_2(σ^*_1, \\mathsf{R})$, we get $p = \\tfrac 13$ and $U_2(σ^*_1, \\mathsf{L}) = U_2(σ^*_1, \\mathsf{C}) = \\tfrac{16}{3}$. \n\n   We now check $U_2(σ^*_1, \\mathsf{C}) = 5p + 2 = \\tfrac{11}{3} \\le \\tfrac{16}{3}$. Thus, the second system of equations has a consistent solution for $p$, $p = \\tfrac{1}{3}$.\n\n   So, we check the first system of equations $U_1(\\mathsf{T}, σ^*_2) = U_1(\\mathsf{B}, σ^*_2)$ (for $q_2 = 0$), which gives $q_1 = \\tfrac{1}{6}$ and $q_3 = \\tfrac{5}{6}$ and the corresponding payoff is $U_1(\\mathsf{T}, σ^*_2) = U_1(\\mathsf{B}, σ^*_2) = \\tfrac{11}{3}$.\n\n   [Thus, $σ^*_1 = (\\tfrac 13, \\tfrac 23)$ and $σ^*_2 = (\\tfrac 16, 0, \\tfrac 56)$ is a NE with payoff $(\\tfrac{11}{3}, \\tfrac{16}{3})$.]{.text-primary}\n\n- **Case 4:** Assume that $\\text{supp}(σ^*_2) = \\{\\mathsf{C}, \\mathsf{R}\\}$, i.e., $q_2, q_3 > 0$ and $q_1 = 0$. By the irrelevance principle, we must have\n   $$\n      U_1(\\mathsf{T}, σ^*_2) = U_1(\\mathsf{B}, σ^*_2) \n   $$\n   and\n   $$\n    U_2(σ^*_1, \\mathsf{C}) = U_2(σ^*_1, \\mathsf{R}) \\ge U_2(σ^*_1, \\mathsf{L}).\n   $$\n   Solving $U_2(σ^*_1, \\mathsf{C}) = U_2(σ^*_1, \\mathsf{R})$, we get $p = \\tfrac 34$ and $U_2(σ^*_1, \\mathsf{C}) = U_2(σ^*_1, \\mathsf{R}) = \\tfrac{23}{4}$. \n\n   We now check $U_2(σ^*_1, \\mathsf{L}) = -5p + 7 = \\tfrac{13}{4} \\le \\tfrac{23}{4}$. Thus, the second system of equations has a consistent solution for $p$, $p = \\tfrac{3}{4}$.\n\n   So, we check the first system of equations $U_1(\\mathsf{T}, σ^*_2) = U_1(\\mathsf{B}, σ^*_2)$ (for $q_1 = 0$), which gives $q_2 = -\\tfrac{1}{4}$ and $q_3 = \\tfrac{5}{4}$, [which is not a valid probability mass function]{.text-warning}. Thus, the first system of equations does not have a consistent solution.\n\nTherefore, the game has a **unique** NE that is identified in Case 3. \n:::\n\n## Proof of the existence of Nash equilibrium\n\nWe now present a proof that every finite game has a NE in mixed strategies. The proof is based on @Nash1950 and relies on [:Kakutani's fixed point theorem](https://en.wikipedia.org/wiki/Kakutani_fixed-point_theorem), which we state below.\n\n:::{#thm-Kakutani}\n#### Kakutani's fixed point theorem\n\nLet $\\ALPHABET X$ be a compact and convex subset of $\\reals^n$ and $f \\colon \\ALPHABET X \\rightrightarrows \\ALPHABET X$ be a set valued correspondence which satisfies:\n\n- for all $x \\in \\ALPHABET X$, the set $f(x)$ is non-empty and convex.\n\n- The graph of $f(x)$ is closed, which means that if we consider two converging sequences $\\{x_n\\}_{n \\ge 1}$ and $\\{y_n\\}_{n \\ge 1}$ such that $x_n \\to x^*$ and $y_n \\to y^*$ such that $y_n \\in f(x_n)$ for all $n$, then $y^* \\in f(x^*)$. \n\nThen $f$ has a fixed point $x^*$, i.e., there exists an $x^* \\in \\ALPHABET X$ such that $x^* \\in f(x^*)$.\n:::\n\nTo use this theorem, we need the notion of **quasi-concave** function, which can be defined in two equivalent ways. \n\n1. **Super-level set definition** Let $\\ALPHABET C$ be a convex subset of $\\reals^n$. A function $g \\colon \\ALPHABET C \\to \\reals$ is said to be quasi-concave if for every $α \\in \\reals$, the super-level set \n   $$\n    \\ALPHABET S^{α} \\coloneqq \\{ x \\in \\ALPHABET C : g(x) \\ge α \\}\n   $$\n   is convex.\n\n2. **Interpolation definition** For the same setup as above, the function $g \\colon \\ALPHABET C \\to \\reals$ is said to be quasi-concave if for every $x, y \\in \\ALPHABET C$ and $λ \\in [0, 1]$\n   $$\n      f(λ x + (1-λ)y) \\le \\min\\{ f(x), f(y) \\}.\n   $$\n   Thus, if we draw a line between two points in $\\ALPHABET C$, then the the value of the function is along this line is never less than the smaller of the two end point values. \n\nQuasi-concavity is a milder assumption that concavity. In particular, a concave function is quasi-concave but the reverse in not true. For example, consider the density of a Gassian random variable:\n$$\n    g(x) = e^{-\\NORM{x}^2}\n$$\nwhich is quasi-concave but not concave.\n\nQuasi-concave functions are useful in optimization because for a quasi-concave function, a local minimum is also a global minimum.\n\nNow we state a theorem which guarantees the existence of Nash equilibrium in pure strategies.\n\n:::{#thm-NE-pure}\nA strategic game $\\mathscr{G} = \\langle N, (\\ALPHABET S_i)_{i \\in N}, (u_i)_{i \\in N} \\rangle$ has a NE in pure strategies if for all $i \\in N$:\n\n- $\\ALPHABET S_i$ is non-empty, compact, and a convex subset of a Eucledian space.\n\n- The utlitiy function $u_i \\colon \\ALPHABET S \\to \\reals$ is continuous in $\\ALPHABET S$ and **quasi-concave** in $\\ALPHABET S_i$.\n:::\n\n:::{.callout-note}\n#### Proof\n\nConsider the set valued map $\\BR \\colon \\ALPHABET S \\rightrightarrows \\ALPHABET S$ define by\n$$\n  \\BR(s) = \\MATRIX{ \\BR_1(s_{-1} \\\\ \\vdots \\\\ B_n(s_{-n}) }.\n$$\nWe verify that $\\BR(s)$ satisfies the conditions of Kakutani's fixed point theorem (@thm-Kakutani).\n\n- For any $i \\in N$ and $s_{-i} \\in \\ALPHABET S_{-i}$, the set $\\BR_i(s_{-i})$ is non-empty because $u_i$ is continuous and $\\ALPHABET S_i$ is compact. \n\n- $\\BR_i(s_{-i})$ is convex because $u_i$ is quasi-concave in $\\ALPHABET S_i$\n\n- $\\BR(s)$ has a closed graph because each $B_i(s_{-i})$ is close because $u_i$ is continuous. \n\nThus, by Kakutani's fixed point theorem, $\\BR(s)$ has a fixed point $s^*$ such that $s^* = \\BR(s^*)$. By definition, such a $s^*$ is a NE.\n:::\n\n:::{#thm-Nash}\n#### Nash\n\nEvery finite strategic game has a NE in mixed strategies.\n:::\n\n:::{.callout-note}\n#### Proof\n\nFor any game $\\mathscr{G}$, consider the mixed extension $\\mathscr{G}'$. If $\\mathscr{G}$ is finite, then\n\n- $Δ(\\ALPHABET S_i)$ is non-empty, compact and convex subset of a Eucledian space.\n\n- $U_i$ is continuous on $Δ(\\ALPHABET S_1) × \\cdots × Δ(\\ALPHABET S_n)$ and linear (and therefore also quasi-concave) on $Δ(\\ALPHABET S_i)$. \n\nHence, by @thm-NE-pure, the mixed extension $\\mathscr{G}'$ has a NE in pure strategies. Thus, the original game $\\mathscr{G}$ has a NE in mixed strategies. \n:::\n\nWe now state a generalization of @thm-Nash without a proof.\n\n:::{#thm-Glicksberg}\n#### Glicksberg\n\nA strategic game $\\mathscr{G} = \\langle N, (\\ALPHABET S_i)_{i \\in N}, (u_i)_{i \\in N} \\rangle$ has a mixed strategy NE if for all $i \\in N$, \n\n- $\\ALPHABET S_i$ is a non-empty, convex, and compact subset of a Eucledian space.\n\n- The utility function $u_i$ is continuous in $\\ALPHABET S$.\n:::\n\nNote that if the utility function $u_i$ is also quasi-concave in $\\ALPHABET S_i$, then by @thm-NE-pure, the game has a pure strategy NE.\n\n## Some examples\n\n:::{#exr-guessing-game}\n#### A guessing game\n\nConsider a two player game with $\\ALPHABET S_1 = \\ALPHABET S_2 = \\{1, \\dots, K\\}$ and the utility functions are given by\n$$\n  u(s_1, s_2) = \\begin{cases} \n  (1, -1), & \\hbox{if } s_1 = s_2 \\\\\n  (0, 0), & \\hbox{otherwise}\n\\end{cases}\n$$\n\n:::\n\n:::{.callout-note}\n#### Solution\n\nLet $σ_1^* = (p_1, \\dots, p_K)$ and $σ^*_2 = (q_1, \\dots, q_K)$ be mixed strategy equilibrium of the game. \n\nIf there is a state $k \\in \\{1, \\dots, K\\}$ such that $p_k > 0$. Then by the indifference principle\n$$\n  U_1(k, σ^*_2) \\ge U_1(\\ell, σ^*_2), \\quad \\forall \\ell \\neq k,\n$$\nwhich implies $q_k \\ge q_{\\ell}$. \n\nSince player 2 must put positive weight on at least one of the pure strategies, we have two possibilities: \n\n- there is some pure strategy $\\ell \\neq k$ such that $q_{\\ell} > 0$. In this case, the above condition implies that $q_k > 0$.\n- for all pure strategies $\\ell \\neq k$, $q_{\\ell} = 0$. In which case, $q_k = 1 > 0$. \n\nThus, we get that if player 1 gives a positive weight to any pure strategy, then player 2 must also give a positive weight to that strategy. \n\nNow suppose there is a state $k \\in \\{1, \\dots, K\\}$ such that $q_k > 0$. Then, by the indifference principle,  \n$$\n  U_2(σ^*_1, k) \\ge U_2(σ^*_2, \\ell), \\quad \\forall \\ell \\neq k,\n$$\nwhich implies $-p_k \\ge -p_{\\ell}$ or $p_k \\le p_{\\ell}$. \n\nSo, we have the following: if player 1 puts a positive weight on a pure strategy $k$, then player 2 should also put positive weight on $k$. But if player 2 puts a positive weight on $k$, then player 1 should put larger weight on all strategies other than $k$. By symmetry (in terms of the choice of strategy), we get that player 1 should put equal weight on all strategies. Therefore, so should player 2.\n:::\n\n:::{#exm-taxation}\n#### Taxation and Auditing\n\nConsider the following game between a population and a tax auditor.\n\n::: {#faa3def9 .cell execution_count=12}\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;H&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;C&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;A&#125;&#36;</td><td>&#36;2&#36;</td><td>&#36;0&#36;</td><td>&#36;4&#36;</td><td>&#36;-10&#36;</td></tr><tr><td>&#36;\\mathsf&#123;N&#125;&#36;</td><td>&#36;4&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td><td>&#36;4&#36;</td></tr></table>\n```\n:::\n:::\n\n\nWhat happens to the equilibrium if the penalty for cheating is increased.\n\n::: {#d0695a7b .cell execution_count=13}\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;H&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;C&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;A&#125;&#36;</td><td>&#36;2&#36;</td><td>&#36;0&#36;</td><td>&#36;4&#36;</td><td>&#36;-20&#36;</td></tr><tr><td>&#36;\\mathsf&#123;N&#125;&#36;</td><td>&#36;4&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td><td>&#36;4&#36;</td></tr></table>\n```\n:::\n:::\n\n\nWhat happens if we increase the benefit of not getting caught\n\n::: {#7a2d3bd4 .cell execution_count=14}\n\n::: {.cell-output .cell-output-display execution_count=30}\n```{=html}\n<table class=\"game\" data-quarto-disable-processing=\"true\" align=\"center\"><tr><td></td><td colspan=\"2\">&#36;\\mathsf&#123;H&#125;&#36;</td><td colspan=\"2\">&#36;\\mathsf&#123;C&#125;&#36;</td></tr><tr><td>&#36;\\mathsf&#123;A&#125;&#36;</td><td>&#36;2&#36;</td><td>&#36;0&#36;</td><td>&#36;4&#36;</td><td>&#36;-10&#36;</td></tr><tr><td>&#36;\\mathsf&#123;N&#125;&#36;</td><td>&#36;4&#36;</td><td>&#36;0&#36;</td><td>&#36;0&#36;</td><td>&#36;8&#36;</td></tr></table>\n```\n:::\n:::\n\n\n:::\n\n",
    "supporting": [
      "nash-equilibrium_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}